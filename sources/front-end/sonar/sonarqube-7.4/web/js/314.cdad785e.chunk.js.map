{"version":3,"sources":["webpack:///./src/main/js/apps/organizations/components/OrganizationEdit.tsx","webpack:///./src/main/js/apps/organizations/actions.ts"],"names":["OrganizationEdit","_super","props","_this","call","this","mounted","handleAvatarInputChange","event","value","target","setState","avatar","changeAvatarImage","avatarImage","handleSubmit","preventDefault","changes","state","description","name","url","loading","updateOrganization","organization","key","then","stopLoading","lodash_debounce__WEBPACK_IMPORTED_MODULE_0___default","__extends","prototype","componentDidMount","componentWillUnmount","render","title","Object","_helpers_l10n__WEBPACK_IMPORTED_MODULE_4__","react__WEBPACK_IMPORTED_MODULE_1__","className","react_helmet__WEBPACK_IMPORTED_MODULE_2___default","a","onSubmit","htmlFor","disabled","id","maxLength","onChange","e","required","type","alt","height","src","rows","_components_ui_buttons__WEBPACK_IMPORTED_MODULE_6__","mapDispatchToProps","_actions__WEBPACK_IMPORTED_MODULE_5__","__webpack_exports__","react_redux__WEBPACK_IMPORTED_MODULE_3__","fetchOrganization","dispatch","Promise","all","_api_organizations__WEBPACK_IMPORTED_MODULE_0__","_a","navigation","organizationWithPermissions","__assign","_store_organizations__WEBPACK_IMPORTED_MODULE_1__","_store_globalMessages__WEBPACK_IMPORTED_MODULE_2__","_helpers_l10n__WEBPACK_IMPORTED_MODULE_3__","deleteOrganization"],"mappings":"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","file":"js/314.cdad785e.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\nimport { connect } from 'react-redux';\nimport { debounce } from 'lodash';\nimport { translate } from '../../../helpers/l10n';\nimport { updateOrganization } from '../actions';\nimport { SubmitButton } from '../../../components/ui/buttons';\nimport { Organization, OrganizationBase } from '../../../app/types';\n\ninterface DispatchProps {\n  updateOrganization: (organization: string, changes: OrganizationBase) => Promise<any>;\n}\n\ninterface OwnProps {\n  organization: Organization;\n}\n\ntype Props = OwnProps & DispatchProps;\n\ninterface State {\n  loading: boolean;\n  avatar: string;\n  avatarImage: string;\n  description: string;\n  name: string;\n  url: string;\n}\n\nexport class OrganizationEdit extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      loading: false,\n      avatar: props.organization.avatar || '',\n      avatarImage: props.organization.avatar || '',\n      description: props.organization.description || '',\n      name: props.organization.name,\n      url: props.organization.url || ''\n    };\n    this.changeAvatarImage = debounce(this.changeAvatarImage, 500);\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleAvatarInputChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const { value } = event.target;\n    this.setState({ avatar: value });\n    this.changeAvatarImage(value);\n  };\n\n  changeAvatarImage = (value: string) => {\n    this.setState({ avatarImage: value });\n  };\n\n  handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const changes = {\n      avatar: this.state.avatar,\n      description: this.state.description,\n      name: this.state.name,\n      url: this.state.url\n    };\n    this.setState({ loading: true });\n    this.props\n      .updateOrganization(this.props.organization.key, changes)\n      .then(this.stopLoading, this.stopLoading);\n  };\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  render() {\n    const title = translate('organization.edit');\n    return (\n      <div className=\"page page-limited\">\n        <Helmet title={title} />\n\n        <header className=\"page-header\">\n          <h1 className=\"page-title\">{title}</h1>\n        </header>\n\n        <div className=\"boxed-group boxed-group-inner\">\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-field\">\n              <label htmlFor=\"organization-name\">\n                {translate('organization.name')}\n                <em className=\"mandatory\">*</em>\n              </label>\n              <input\n                disabled={this.state.loading}\n                id=\"organization-name\"\n                maxLength={255}\n                name=\"name\"\n                onChange={e => this.setState({ name: e.target.value })}\n                required={true}\n                type=\"text\"\n                value={this.state.name}\n              />\n              <div className=\"modal-field-description\">\n                {translate('organization.name.description')}\n              </div>\n            </div>\n            <div className=\"modal-field\">\n              <label htmlFor=\"organization-avatar\">{translate('organization.avatar')}</label>\n              <input\n                disabled={this.state.loading}\n                id=\"organization-avatar\"\n                maxLength={256}\n                name=\"avatar\"\n                onChange={this.handleAvatarInputChange}\n                type=\"text\"\n                value={this.state.avatar}\n              />\n              <div className=\"modal-field-description\">\n                {translate('organization.avatar.description')}\n              </div>\n              {!!this.state.avatarImage && (\n                <div className=\"spacer-top spacer-bottom\">\n                  <div className=\"little-spacer-bottom\">\n                    {translate('organization.avatar.preview')}\n                    {':'}\n                  </div>\n                  <img alt=\"\" height={30} src={this.state.avatarImage} />\n                </div>\n              )}\n            </div>\n            <div className=\"modal-field\">\n              <label htmlFor=\"organization-description\">{translate('description')}</label>\n              <textarea\n                disabled={this.state.loading}\n                id=\"organization-description\"\n                maxLength={256}\n                name=\"description\"\n                onChange={e => this.setState({ description: e.target.value })}\n                rows={3}\n                value={this.state.description}\n              />\n              <div className=\"modal-field-description\">\n                {translate('organization.description.description')}\n              </div>\n            </div>\n            <div className=\"modal-field\">\n              <label htmlFor=\"organization-url\">{translate('organization.url')}</label>\n              <input\n                disabled={this.state.loading}\n                id=\"organization-url\"\n                maxLength={256}\n                name=\"url\"\n                onChange={e => this.setState({ url: e.target.value })}\n                type=\"text\"\n                value={this.state.url}\n              />\n              <div className=\"modal-field-description\">\n                {translate('organization.url.description')}\n              </div>\n            </div>\n            <div className=\"modal-field\">\n              <SubmitButton disabled={this.state.loading}>{translate('save')}</SubmitButton>\n              {this.state.loading && <i className=\"spinner spacer-left\" />}\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapDispatchToProps = { updateOrganization: updateOrganization as any };\n\nexport default connect(\n  null,\n  mapDispatchToProps\n)(OrganizationEdit);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Dispatch } from 'redux';\nimport * as api from '../../api/organizations';\nimport * as actions from '../../store/organizations';\nimport { addGlobalSuccessMessage } from '../../store/globalMessages';\nimport { translate, translateWithParameters } from '../../helpers/l10n';\nimport { Organization, OrganizationBase } from '../../app/types';\nimport { Store } from '../../store/rootReducer';\n\nexport const fetchOrganization = (key: string) => (dispatch: Dispatch<Store>) => {\n  return Promise.all([api.getOrganization(key), api.getOrganizationNavigation(key)]).then(\n    ([organization, navigation]) => {\n      if (organization) {\n        const organizationWithPermissions = { ...organization, ...navigation };\n        dispatch(actions.receiveOrganizations([organizationWithPermissions]));\n      }\n    }\n  );\n};\n\nexport const createOrganization = (organization: OrganizationBase) => (\n  dispatch: Dispatch<Store>\n) => {\n  return api.createOrganization(organization).then((organization: Organization) => {\n    dispatch(actions.createOrganization(organization));\n    dispatch(\n      addGlobalSuccessMessage(translateWithParameters('organization.created', organization.name))\n    );\n    return organization;\n  });\n};\n\nexport const updateOrganization = (key: string, changes: OrganizationBase) => (\n  dispatch: Dispatch<Store>\n) => {\n  return api.updateOrganization(key, changes).then(() => {\n    dispatch(actions.updateOrganization(key, changes));\n    dispatch(addGlobalSuccessMessage(translate('organization.updated')));\n  });\n};\n\nexport const deleteOrganization = (key: string) => (dispatch: Dispatch<Store>) => {\n  return api.deleteOrganization(key).then(() => {\n    dispatch(actions.deleteOrganization(key));\n    dispatch(addGlobalSuccessMessage(translate('organization.deleted')));\n  });\n};\n"],"sourceRoot":""}
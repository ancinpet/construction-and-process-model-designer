{"version":3,"sources":["webpack:///./src/main/js/apps/permissions/global/components/PageHeader.tsx","webpack:///./src/main/js/apps/permissions/global/components/AllHoldersList.tsx","webpack:///./src/main/js/apps/permissions/global/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx","webpack:///./src/main/js/components/controls/ListFooter.tsx","webpack:///./src/main/js/apps/organizations/forSingleOrganization.tsx"],"names":["_super","PageHeader","__extends","prototype","render","title","this","props","organization","Object","l10n","description","index_js_exposed","className","loading","AllHoldersList_AllHoldersList","AllHoldersList","_this","apply","arguments","handleToggleUser","user","permission","permissions","includes","revokePermissionFromUser","login","grantPermissionToUser","handleToggleGroup","group","revokePermissionFromGroup","name","grantPermissionToGroup","AllHoldersList_extends","_a","filter","groups","groupsPaging","users","usersPaging","l10nPrefix","governanceInstalled","appState","qualifiers","utils","count","total","length","HoldersList","onToggleGroup","onToggleUser","query","SearchForm","onFilter","onSearch","ListFooter","loadMore","onLoadMore","components_AllHoldersList","es","state","rootReducer","App_App","App","call","mounted","loadUsersAndGroups","userPage","groupsPage","getUsers","api_permissions","q","undefined","key","p","Promise","resolve","paging","getGroups","all","loadHolders","setState","then","usersResponse","groupsResponse","stopLoading","pageIndex","concat","addPermissionToGroup","map","candidate","__assign","addPermissionToUser","removePermissionFromGroup","without_default","removePermissionFromUser","groupName","App_extends","componentDidMount","componentWillUnmount","Suggestions","suggestions","Helmet_default","a","components_PageHeader","__webpack_exports__","forSingleOrganization","context","addSuggestions","componentDidUpdate","prevProps","removeSuggestions","contextTypes","prop_types__WEBPACK_IMPORTED_MODULE_1__","isRequired","react__WEBPACK_IMPORTED_MODULE_0__","_b","ready","__rest","hasMore","loadMoreLink","href","onClick","event","preventDefault","currentTarget","blur","_helpers_l10n__WEBPACK_IMPORTED_MODULE_3__","classnames__WEBPACK_IMPORTED_MODULE_1__","new-loading","_helpers_measures__WEBPACK_IMPORTED_MODULE_4__","_common_DeferredSpinner__WEBPACK_IMPORTED_MODULE_2__","ComposedComponent","ForSingleOrganization","customOrganizations","router","other","params","organizationKey","replace","displayName","react_redux__WEBPACK_IMPORTED_MODULE_1__","_store_rootReducer__WEBPACK_IMPORTED_MODULE_3__","react_router__WEBPACK_IMPORTED_MODULE_2__"],"mappings":"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","file":"js/268.a3e4869b.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from '../../../../helpers/l10n';\n\ninterface Props {\n  loading?: boolean;\n  organization?: {};\n}\n\nexport default class PageHeader extends React.PureComponent<Props> {\n  render() {\n    const title = this.props.organization\n      ? translate('permissions.page')\n      : translate('global_permissions.page');\n\n    const description = this.props.organization\n      ? translate('organization_permissions.page.description')\n      : translate('global_permissions.page.description');\n\n    return (\n      <header className=\"page-header\">\n        <h1 className=\"page-title\">{title}</h1>\n\n        {this.props.loading && <i className=\"spinner\" />}\n\n        <div className=\"page-description\">{description}</div>\n      </header>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport SearchForm from '../../shared/components/SearchForm';\nimport HoldersList from '../../shared/components/HoldersList';\nimport ListFooter from '../../../../components/controls/ListFooter';\nimport {\n  AppState,\n  Organization,\n  Paging,\n  PermissionGroup,\n  PermissionUser\n} from '../../../../app/types';\nimport {\n  PERMISSIONS_ORDER_GLOBAL,\n  convertToPermissionDefinitions,\n  PERMISSIONS_ORDER_GLOBAL_GOV\n} from '../../utils';\nimport { Store, getAppState } from '../../../../store/rootReducer';\n\ninterface StateProps {\n  appState: Pick<AppState, 'qualifiers'>;\n}\n\ninterface OwnProps {\n  filter: string;\n  grantPermissionToGroup: (groupName: string, permission: string) => Promise<void>;\n  grantPermissionToUser: (login: string, permission: string) => Promise<void>;\n  groups: PermissionGroup[];\n  groupsPaging?: Paging;\n  loadHolders: () => void;\n  loading?: boolean;\n  onLoadMore: () => void;\n  onFilter: (filter: string) => void;\n  onSearch: (query: string) => void;\n  organization?: Organization;\n  query: string;\n  revokePermissionFromGroup: (groupName: string, permission: string) => Promise<void>;\n  revokePermissionFromUser: (login: string, permission: string) => Promise<void>;\n  users: PermissionUser[];\n  usersPaging?: Paging;\n}\n\ntype Props = StateProps & OwnProps;\n\nexport class AllHoldersList extends React.PureComponent<Props> {\n  handleToggleUser = (user: PermissionUser, permission: string) => {\n    const hasPermission = user.permissions.includes(permission);\n    if (hasPermission) {\n      return this.props.revokePermissionFromUser(user.login, permission);\n    } else {\n      return this.props.grantPermissionToUser(user.login, permission);\n    }\n  };\n\n  handleToggleGroup = (group: PermissionGroup, permission: string) => {\n    const hasPermission = group.permissions.includes(permission);\n\n    if (hasPermission) {\n      return this.props.revokePermissionFromGroup(group.name, permission);\n    } else {\n      return this.props.grantPermissionToGroup(group.name, permission);\n    }\n  };\n\n  render() {\n    const { filter, groups, groupsPaging, users, usersPaging } = this.props;\n    const l10nPrefix = this.props.organization ? 'organizations_permissions' : 'global_permissions';\n    const governanceInstalled = this.props.appState.qualifiers.includes('VW');\n    const permissions = convertToPermissionDefinitions(\n      governanceInstalled ? PERMISSIONS_ORDER_GLOBAL_GOV : PERMISSIONS_ORDER_GLOBAL,\n      l10nPrefix\n    );\n\n    let count = 0;\n    let total = 0;\n    if (filter !== 'users') {\n      count += groups.length;\n      total += groupsPaging ? groupsPaging.total : groups.length;\n    }\n    if (filter !== 'groups') {\n      count += users.length;\n      total += usersPaging ? usersPaging.total : users.length;\n    }\n\n    return (\n      <>\n        <HoldersList\n          filter={this.props.filter}\n          groups={this.props.groups}\n          loading={this.props.loading}\n          onToggleGroup={this.handleToggleGroup}\n          onToggleUser={this.handleToggleUser}\n          permissions={permissions}\n          query={this.props.query}\n          users={this.props.users}>\n          <SearchForm\n            filter={this.props.filter}\n            onFilter={this.props.onFilter}\n            onSearch={this.props.onSearch}\n            query={this.props.query}\n          />\n        </HoldersList>\n        <ListFooter count={count} loadMore={this.props.onLoadMore} total={total} />\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store): StateProps => ({\n  appState: getAppState(state)\n});\n\nexport default connect(mapStateToProps)(AllHoldersList);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Helmet from 'react-helmet';\nimport { without } from 'lodash';\nimport PageHeader from './PageHeader';\nimport AllHoldersList from './AllHoldersList';\nimport * as api from '../../../../api/permissions';\nimport Suggestions from '../../../../app/components/embed-docs-modal/Suggestions';\nimport { translate } from '../../../../helpers/l10n';\nimport { Organization, Paging, PermissionGroup, PermissionUser } from '../../../../app/types';\nimport forSingleOrganization from '../../../organizations/forSingleOrganization';\nimport '../../styles.css';\n\ninterface Props {\n  organization?: Organization;\n}\n\ninterface State {\n  filter: 'all' | 'groups' | 'users';\n  groups: PermissionGroup[];\n  groupsPaging?: Paging;\n  loading: boolean;\n  query: string;\n  users: PermissionUser[];\n  usersPaging?: Paging;\n}\n\nexport class App extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      filter: 'all',\n      groups: [],\n      loading: true,\n      query: '',\n      users: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadUsersAndGroups = (userPage?: number, groupsPage?: number) => {\n    const { organization } = this.props;\n    const { filter, query } = this.state;\n\n    const getUsers: Promise<{ paging?: Paging; users: PermissionUser[] }> =\n      filter !== 'groups'\n        ? api.getGlobalPermissionsUsers({\n            q: query || undefined,\n            organization: organization && organization.key,\n            p: userPage\n          })\n        : Promise.resolve({ paging: undefined, users: [] });\n\n    const getGroups: Promise<{ paging?: Paging; groups: PermissionGroup[] }> =\n      filter !== 'users'\n        ? api.getGlobalPermissionsGroups({\n            q: query || undefined,\n            organization: organization && organization.key,\n            p: groupsPage\n          })\n        : Promise.resolve({ paging: undefined, groups: [] });\n\n    return Promise.all([getUsers, getGroups]);\n  };\n\n  loadHolders = () => {\n    this.setState({ loading: true });\n    return this.loadUsersAndGroups().then(([usersResponse, groupsResponse]) => {\n      if (this.mounted) {\n        this.setState({\n          groups: groupsResponse.groups,\n          groupsPaging: groupsResponse.paging,\n          loading: false,\n          users: usersResponse.users,\n          usersPaging: usersResponse.paging\n        });\n      }\n    }, this.stopLoading);\n  };\n\n  onLoadMore = () => {\n    const { usersPaging, groupsPaging } = this.state;\n    this.setState({ loading: true });\n    return this.loadUsersAndGroups(\n      usersPaging ? usersPaging.pageIndex + 1 : 1,\n      groupsPaging ? groupsPaging.pageIndex + 1 : 1\n    ).then(([usersResponse, groupsResponse]) => {\n      if (this.mounted) {\n        this.setState(({ groups, users }) => ({\n          groups: [...groups, ...groupsResponse.groups],\n          groupsPaging: groupsResponse.paging,\n          loading: false,\n          users: [...users, ...usersResponse.users],\n          usersPaging: usersResponse.paging\n        }));\n      }\n    }, this.stopLoading);\n  };\n\n  onFilter = (filter: 'all' | 'groups' | 'users') => {\n    this.setState({ filter }, this.loadHolders);\n  };\n\n  onSearch = (query: string) => {\n    this.setState({ query }, this.loadHolders);\n  };\n\n  addPermissionToGroup = (groups: PermissionGroup[], group: string, permission: string) => {\n    return groups.map(\n      candidate =>\n        candidate.name === group\n          ? { ...candidate, permissions: [...candidate.permissions, permission] }\n          : candidate\n    );\n  };\n\n  addPermissionToUser = (users: PermissionUser[], user: string, permission: string) => {\n    return users.map(\n      candidate =>\n        candidate.login === user\n          ? { ...candidate, permissions: [...candidate.permissions, permission] }\n          : candidate\n    );\n  };\n\n  removePermissionFromGroup = (groups: PermissionGroup[], group: string, permission: string) => {\n    return groups.map(\n      candidate =>\n        candidate.name === group\n          ? { ...candidate, permissions: without(candidate.permissions, permission) }\n          : candidate\n    );\n  };\n\n  removePermissionFromUser = (users: PermissionUser[], user: string, permission: string) => {\n    return users.map(\n      candidate =>\n        candidate.login === user\n          ? { ...candidate, permissions: without(candidate.permissions, permission) }\n          : candidate\n    );\n  };\n\n  grantPermissionToGroup = (group: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ groups }) => ({\n        groups: this.addPermissionToGroup(groups, group, permission)\n      }));\n      return api\n        .grantPermissionToGroup({\n          groupName: group,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ groups }) => ({\n                groups: this.removePermissionFromGroup(groups, group, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  grantPermissionToUser = (user: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ users }) => ({\n        users: this.addPermissionToUser(users, user, permission)\n      }));\n      return api\n        .grantPermissionToUser({\n          login: user,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ users }) => ({\n                users: this.removePermissionFromUser(users, user, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromGroup = (group: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ groups }) => ({\n        groups: this.removePermissionFromGroup(groups, group, permission)\n      }));\n      return api\n        .revokePermissionFromGroup({\n          groupName: group,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ groups }) => ({\n                groups: this.addPermissionToGroup(groups, group, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  revokePermissionFromUser = (user: string, permission: string) => {\n    if (this.mounted) {\n      this.setState(({ users }) => ({\n        users: this.removePermissionFromUser(users, user, permission)\n      }));\n      return api\n        .revokePermissionFromUser({\n          login: user,\n          permission,\n          organization: this.props.organization && this.props.organization.key\n        })\n        .then(\n          () => {},\n          () => {\n            if (this.mounted) {\n              this.setState(({ users }) => ({\n                users: this.addPermissionToUser(users, user, permission)\n              }));\n            }\n          }\n        );\n    }\n    return Promise.resolve();\n  };\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"page page-limited\">\n        <Suggestions suggestions=\"global_permissions\" />\n        <Helmet title={translate('global_permissions.permission')} />\n        <PageHeader loading={this.state.loading} organization={this.props.organization} />\n        <AllHoldersList\n          filter={this.state.filter}\n          grantPermissionToGroup={this.grantPermissionToGroup}\n          grantPermissionToUser={this.grantPermissionToUser}\n          groups={this.state.groups}\n          groupsPaging={this.state.groupsPaging}\n          loadHolders={this.loadHolders}\n          loading={this.state.loading}\n          onFilter={this.onFilter}\n          onLoadMore={this.onLoadMore}\n          onSearch={this.onSearch}\n          query={this.state.query}\n          revokePermissionFromGroup={this.revokePermissionFromGroup}\n          revokePermissionFromUser={this.revokePermissionFromUser}\n          users={this.state.users}\n          usersPaging={this.state.usersPaging}\n        />\n      </div>\n    );\n  }\n}\n\nexport default forSingleOrganization(App);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default class Suggestions extends React.PureComponent<Props> {\n  context!: { suggestions: SuggestionsContext };\n\n  static contextTypes = {\n    suggestions: PropTypes.object.isRequired\n  };\n\n  componentDidMount() {\n    this.context.suggestions.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.context.suggestions.removeSuggestions(this.props.suggestions);\n      this.context.suggestions.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.context.suggestions.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport DeferredSpinner from '../common/DeferredSpinner';\nimport { translate, translateWithParameters } from '../../helpers/l10n';\nimport { formatMeasure } from '../../helpers/measures';\n\ninterface Props {\n  count: number;\n  className?: string;\n  loading?: boolean;\n  loadMore?: () => void;\n  ready?: boolean;\n  total?: number;\n}\n\nexport default function ListFooter({ ready = true, ...props }: Props) {\n  const handleLoadMore = (event: React.SyntheticEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (props.loadMore) {\n      props.loadMore();\n    }\n  };\n\n  const hasMore = props.total && props.total > props.count;\n  const loadMoreLink = (\n    <a className=\"spacer-left\" href=\"#\" onClick={handleLoadMore}>\n      {translate('show_more')}\n    </a>\n  );\n  const className = classNames(\n    'spacer-top note text-center',\n    { 'new-loading': !ready },\n    props.className\n  );\n\n  return (\n    <footer className={className}>\n      {translateWithParameters(\n        'x_of_y_shown',\n        formatMeasure(props.count, 'INT', null),\n        formatMeasure(props.total, 'INT', null)\n      )}\n      {props.loadMore != null && hasMore ? loadMoreLink : null}\n      {props.loading && (\n        <DeferredSpinner className=\"vertical-bottom spacer-left position-absolute\" />\n      )}\n    </footer>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter, WithRouterProps } from 'react-router';\nimport { areThereCustomOrganizations, Store } from '../../store/rootReducer';\n\ntype ReactComponent<P> = React.ComponentClass<P> | React.StatelessComponent<P>;\n\nexport default function forSingleOrganization<P>(ComposedComponent: ReactComponent<P>) {\n  interface StateProps {\n    customOrganizations: boolean | undefined;\n  }\n\n  class ForSingleOrganization extends React.Component<StateProps & WithRouterProps> {\n    static displayName = `forSingleOrganization(${ComposedComponent.displayName})}`;\n\n    render() {\n      const { customOrganizations, router, ...other } = this.props;\n\n      if (!other.params.organizationKey && customOrganizations) {\n        router.replace('/not_found');\n        return null;\n      }\n\n      return <ComposedComponent {...other} />;\n    }\n  }\n\n  const mapStateToProps = (state: Store) => ({\n    customOrganizations: areThereCustomOrganizations(state)\n  });\n\n  return connect(mapStateToProps)(withRouter(ForSingleOrganization));\n}\n"],"sourceRoot":""}